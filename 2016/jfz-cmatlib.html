<!doctype html>



  


<html class="theme-next mist use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
    
  
  <link href="//cdn.jsdelivr.net/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|consolas:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






  

<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.2/css/font-awesome.min.css" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Sandeepin" />





  <link rel="alternate" href="/atom.xml" title="异想博客" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="Sandeepin最近做的项目中需要在嵌入式芯片里跑一些算法，而这些单片机性能不上不下，它能跑些简单的程序，但又还没到上Linux系统的地步。所以只好用C语言写一些在高级语言里一个函数就解决的算法了，由于算法需要运用矩阵运算，自己就先用纯C语言写了个简单的矩阵运算库。 代码只实现了矩阵最基本的运算，包括矩阵的加、减、乘、数乘、转置、行列式、逆矩阵、代数余子式、伴随矩阵等运算。此外增加了一些实用函数">
<meta property="og:type" content="article">
<meta property="og:title" content="异想家纯C语言矩阵运算库">
<meta property="og:url" content="http://blog.jfz.me/2016/jfz-cmatlib.html">
<meta property="og:site_name" content="异想博客">
<meta property="og:description" content="Sandeepin最近做的项目中需要在嵌入式芯片里跑一些算法，而这些单片机性能不上不下，它能跑些简单的程序，但又还没到上Linux系统的地步。所以只好用C语言写一些在高级语言里一个函数就解决的算法了，由于算法需要运用矩阵运算，自己就先用纯C语言写了个简单的矩阵运算库。 代码只实现了矩阵最基本的运算，包括矩阵的加、减、乘、数乘、转置、行列式、逆矩阵、代数余子式、伴随矩阵等运算。此外增加了一些实用函数">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2018-05-19T16:05:02.071Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="异想家纯C语言矩阵运算库">
<meta name="twitter:description" content="Sandeepin最近做的项目中需要在嵌入式芯片里跑一些算法，而这些单片机性能不上不下，它能跑些简单的程序，但又还没到上Linux系统的地步。所以只好用C语言写一些在高级语言里一个函数就解决的算法了，由于算法需要运用矩阵运算，自己就先用纯C语言写了个简单的矩阵运算库。 代码只实现了矩阵最基本的运算，包括矩阵的加、减、乘、数乘、转置、行列式、逆矩阵、代数余子式、伴随矩阵等运算。此外增加了一些实用函数">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"right","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 'undefined',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://blog.jfz.me/2016/jfz-cmatlib.html"/>





<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
<style>
    .pace .pace-progress {
        background: #1E92FB; /*进度条颜色*/
        height: 3px;
    }
    .pace .pace-progress-inner {
         box-shadow: 0 0 10px #1E92FB, 0 0 5px     #1E92FB; /*阴影颜色*/
    }
    .pace .pace-activity {
        border-top-color: #1E92FB;    /*上边框颜色*/
        border-left-color: #1E92FB;    /*左边框颜色*/
    }
</style>


  <title> 异想家纯C语言矩阵运算库 | 异想博客 </title>
</head>

  	 <!-- custom analytics part create by xiamo -->
<script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
<script>AV.initialize("kJ2sJuSJeByLioULSXrJ5CSq-9Nh9j0Va", "uBWeNxCbFEWsOVDTmAInrDq3");</script>
<script>
function showTime(Counter) {
	var query = new AV.Query(Counter);
	$(".leancloud_visitors").each(function() {
		var url = $(this).attr("id").trim();
		query.equalTo("url", url);
		query.find({
			success: function(results) {
				if (results.length == 0) {
					var content = $(document.getElementById(url)).text() + ': 0';
					$(document.getElementById(url)).text(content);
					return;
				}
				for (var i = 0; i < results.length; i++) {
					var object = results[i];
					var content = $(document.getElementById(url)).text() + ': ' + object.get('time');
					$(document.getElementById(url)).text(content);
				}
			},
			error: function(object, error) {
				console.log("Error: " + error.code + " " + error.message);
			}
		});

	});
}

function addCount(Counter) {
	var Counter = AV.Object.extend("Counter");
	url = $(".leancloud_visitors").attr('id').trim();
	title = $(".leancloud_visitors").attr('data-flag-title').trim();
	var query = new AV.Query(Counter);
	query.equalTo("url", url);
	query.find({
		success: function(results) {
			if (results.length > 0) {
				var counter = results[0];
				counter.fetchWhenSave(true);
				counter.increment("time");
				counter.save(null, {
					success: function(counter) {
						var content = $(document.getElementById(url)).text() + ': ' + counter.get('time');
						$(document.getElementById(url)).text(content);
					},
					error: function(counter, error) {
						console.log('Failed to save Visitor num, with error message: ' + error.message);
					}
				});
			} else {
				var newcounter = new Counter();
				newcounter.set("title", title);
				newcounter.set("url", url);
				newcounter.set("time", 1);
				newcounter.save(null, {
					success: function(newcounter) {
					    console.log("newcounter.get('time')="+newcounter.get('time'));
						var content = $(document.getElementById(url)).text() + ': ' + newcounter.get('time');
						$(document.getElementById(url)).text(content);
					},
					error: function(newcounter, error) {
						console.log('Failed to create');
					}
				});
			}
		},
		error: function(error) {
			console.log('Error:' + error.code + " " + error.message);
		}
	});
}
$(function() {
	var Counter = AV.Object.extend("Counter");
	if ($('.leancloud_visitors').length == 1) {
		addCount(Counter);
	} else if ($('.post-title-link').length > 1) {
		showTime(Counter);
	}
});
</script>
  
<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?340874ba9357cbe81570aa4ac1185941";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-right page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta custom-logo">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">异想博客</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <h1 class="site-subtitle" itemprop="description">异想家博采众长的客厅！</h1>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://blog.jfz.me/2016/jfz-cmatlib.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Sandeepin">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="异想博客">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="异想博客" src="/images/avatar.jpg">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                异想家纯C语言矩阵运算库
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-30T19:06:56+08:00">
                2016-11-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程开发/" itemprop="url" rel="index">
                    <span itemprop="name">编程开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
		  
			 
          
          
             <span id="/2016/jfz-cmatlib.html" class="leancloud_visitors" data-flag-title="异想家纯C语言矩阵运算库">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors </span>
               
                 <span class="leancloud-visitors-count"></span>
				 <span>℃</span>
             </span>
          
		   
          

		  
            <div class="post-wordcount">
              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          
		  
          
 
        


        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>Sandeepin最近做的项目中需要在嵌入式芯片里跑一些算法，而这些单片机性能不上不下，它能跑些简单的程序，但又还没到上Linux系统的地步。所以只好用C语言写一些在高级语言里一个函数就解决的算法了，由于算法需要运用矩阵运算，自己就先用纯C语言写了个简单的矩阵运算库。 代码只实现了矩阵最基本的运算，包括矩阵的加、减、乘、数乘、转置、行列式、逆矩阵、代数余子式、伴随矩阵等运算。此外增加了一些实用函数，如显示矩阵、从csv文件读取保存矩阵等函数。具体的例子在主函数中体现，其中还用自己这个矩阵运算库做了一个简单的应用，利用公式β=(X’X)^(-1)X’Y来进行多元线性回归系数计算，大家可以参考参考，欢迎批评。 JfzMatLib.c文件代码：</p>
<p>#include “JfzMatLib.h”  </p>
<p>int main(int argc, char*<em> argv)<br>{<br>    //矩阵的基本运算：加、减、乘、数乘、转置、行列式、逆矩阵、代数余子式、伴随矩阵<br>    //初始实验矩阵<br>    double A[] = { -3, 2, -5, -1, 0, -2, 3, -4, 1 };<br>    double B[] = { 1, 4, 7, 3, 0, 5, -1, 9, 11 };<br>    double C[] = { 1, 2, 3, 4, 5, 6, 7, 8, 9 };<br>    //计算结果矩阵<br>    double \</em>Add = (double*)malloc(sizeof(double) <em> 9);<br>    double \</em>Sub = (double*)malloc(sizeof(double) <em> 9);<br>    double \</em>Mul = (double*)malloc(sizeof(double) <em> 9);<br>    double \</em>kMat = (double*)malloc(sizeof(double) <em> 9);<br>    double \</em>CT = (double*)malloc(sizeof(double) <em> 9);<br>    double \</em>AInv = (double*)malloc(sizeof(double) <em> 9);<br>    double \</em>Adj = (double*)malloc(sizeof(double) <em> 9);<br>    //显示矩阵A、B、C<br>    printf(“A：\n”); MatShow(A, 3, 3);<br>    printf(“B：\n”); MatShow(B, 3, 3);<br>    printf(“C：\n”); MatShow(C, 3, 3);<br>    //矩阵相加<br>    printf(“A+B：\n”);<br>    Add = MatAdd(A, B, 3, 3); MatShow(Add, 3, 3);<br>    //矩阵相减<br>    printf(“A-B：\n”);<br>    Sub = MatSub(A, B, 3, 3); MatShow(Sub, 3, 3);<br>    //矩阵相乘<br>    printf(“A</em>B：\n”);<br>    Mul = MatMul(A, 3, 3, B, 3, 3); MatShow(Mul, 3, 3);<br>    //矩阵数乘<br>    printf(“2*C：\n”);<br>    kMat = MatMulk(C, 3, 3, 2); MatShow(kMat, 3, 3);<br>    //矩阵转置<br>    printf(“C的转置：\n”);<br>    CT = MatT(C, 3, 3); MatShow(CT, 3, 3);<br>    //矩阵行列式值<br>    printf(“B的行列式值：\n”);<br>    printf(“%16lf\n”, MatDet(B, 3));<br>    printf(“C的行列式值：\n”);<br>    printf(“%16lf\n”, MatDet(C, 3));<br>    //矩阵的逆<br>    printf(“A的逆：\n”);<br>    AInv = MatInv(A, 3, 3); MatShow(AInv, 3, 3);<br>    printf(“C的逆：\n”);<br>    MatInv(C, 3, 3);<br>    //矩阵代数余子式<br>    printf(“C的(0,0)元素的代数余子式：\n”);<br>    printf(“%16lf\n”, MatACof(C, 3, 0, 0));<br>    //矩阵伴随矩阵<br>    printf(“A的伴随矩阵：\n”);<br>    Adj = MatAdj(A, 3, 3); MatShow(Adj, 3, 3);  </p>
<pre><code>//蒋方正矩阵库应用：多元线性回归  
//多元线性回归公式：β=(X&apos;X)^(-1)X&apos;Y  
double X\[15\]\[5\] = {  
    1, 316, 1536, 874, 981,//第一列要补1  
    1, 385, 1771, 777, 1386,  
    1, 299, 1565, 678, 1672,  
    1, 326, 1970, 785, 1864,  
    1, 441, 1890, 785, 2143,  
    1, 460, 2050, 709, 2176,  
    1, 470, 1873, 673, 1769,  
    1, 504, 1955, 793, 2207,  
    1, 348, 2016, 968, 2251,  
    1, 400, 2199, 944, 2390,  
    1, 496, 1328, 749, 2287,  
    1, 497, 1920, 952, 2388,  
    1, 533, 1400, 1452, 2093,  
    1, 506, 1612, 1587, 2083,  
    1, 458, 1613, 1485, 2390  
};  
double Y\[15\]\[1\] = {  
    3894,  
    4628,  
    4569,  
    5340,  
    5449,  
    5599,  
    5010,  
    5694,  
    5792,  
    6126,  
    5025,  
    5924,  
    5657,  
    6019,  
    6141  
};  
//多元线性回归公式：β=(X&apos;X)^(-1)X&apos;Y  
double \*XT = (double\*)malloc(sizeof(double) * 5 * 15);  
double \*XTX = (double\*)malloc(sizeof(double) * 5 * 5);  
double \*InvXTX = (double\*)malloc(sizeof(double) * 5 * 5);  
double \*InvXTXXT = (double\*)malloc(sizeof(double) * 5 * 15);  
double \*InvXTXXTY = (double\*)malloc(sizeof(double) * 5 * 1);  
XT = MatT((double*)X, 15, 5);  
XTX = MatMul(XT, 5, 15, (double*)X, 15, 5);  
InvXTX = MatInv(XTX, 5, 5);  
InvXTXXT = MatMul(InvXTX, 5, 5, XT, 5, 15);  
InvXTXXTY = MatMul(InvXTXXT, 5, 15, (double*)Y, 15, 1);  
printf(&quot;多元线性回归β系数：\\n&quot;);  
MatShow(InvXTXXTY, 5, 1);  

//保存矩阵到csv  
MatWrite(&quot;XTX.csv&quot;, XTX, 5, 5);  
MatWrite(&quot;InvXTXXTY.csv&quot;, InvXTXXTY, 5, 1);  
MatWrite(&quot;Fuck.csv&quot;, A, 3, 3);  
MatWrite(&quot;Fuck2.csv&quot;, A, 9, 1);  

//从csv读取矩阵  
double \*Fuck = (double\*)malloc(sizeof(double) * 3 * 3);  
Fuck = MatRead(&quot;Fuck.csv&quot;);  
MatShow(Fuck, 3, 3);  

double \*Fuck2 = (double\*)malloc(sizeof(double) * 9 * 1);  
Fuck2 = MatRead(&quot;Fuck2.csv&quot;);  
MatShow(Fuck2, 9, 1);  

double \*InvXTXXTYread = (double\*)malloc(sizeof(double) * 5 * 1);  
InvXTXXTYread = MatRead(&quot;InvXTXXTY.csv&quot;);  
MatShow(InvXTXXTYread, 5, 1);  

double \*XTXread = (double\*)malloc(sizeof(double) * 5 * 5);  
XTXread = MatRead(&quot;XTX.csv&quot;);  
MatShow(XTXread, 5, 5);  
system(&quot;pause&quot;);  
</code></pre><p>}</p>
<p>JfzMatLib.h头文件代码：</p>
<p>#include &lt;stdio.h&gt;  </p>
<p>#include &lt;stdlib.h&gt;  </p>
<p>#include &lt;string.h&gt;  </p>
<p>void    MatShow(double<em> Mat, int row, int col);<br>double</em> MatAdd(double<em> A, double</em> B, int row, int col);<br>double<em> MatSub(double</em> A, double<em> B, int row, int col);<br>double</em> MatMul(double<em> A, int Arow, int Acol, double</em> B, int Brow, int Bcol);<br>double<em> MatMulk(double </em>A, int row, int col, double k);<br>double<em> MatT(double</em> A, int row, int col);<br>double  MatDet(double <em>A, int row);<br>double</em> MatInv(double <em>A, int row, int col);<br>double  MatACof(double </em>A, int row, int m, int n);<br>double<em> MatAdj(double </em>A, int row, int col);<br>double *MatRead(char *csvFileName, int row, int col);<br>void MatWrite(char *A, int row, int col);  </p>
<p>// (det用)功能：求逆序对的个数<br>int inver_order(int list[], int n)<br>{<br>    int ret = 0;<br>    for (int i = 1; i &lt; n; i++)<br>        for (int j = 0; j &lt; i; j++)<br>            if (list[j] &gt; list[i])<br>                ret++;<br>    return ret;<br>}  </p>
<p>// (det用)功能：符号函数，正数返回1，负数返回-1<br>int sgn(int order)<br>{<br>    return order % 2 ? -1 : 1;<br>}  </p>
<p>// (det用)功能：交换两整数a、b的值<br>void swap(int *a, int *b)<br>{<br>    int m;<br>    m = <em>a;<br>    \</em>a = *b;<br>    *b = m;<br>}  </p>
<p>// 功能：求矩阵行列式的核心函数<br>double det(double <em>p, int n, int k, int list[], double sum)<br>{<br>    if (k &gt;= n)<br>    {<br>        int order = inver_order(list, n);<br>        double item = (double)sgn(order);<br>        for (int i = 0; i &lt; n; i++)<br>        {<br>            //item </em>= p[i][list[i]];<br>            item <em>= </em>(p + i * n + list[i]);<br>        }<br>        return sum + item;<br>    }<br>    else<br>    {<br>        for (int i = k; i &lt; n; i++)<br>        {<br>            swap(&amp;list[k], &amp;list[i]);<br>            sum = det(p, n, k + 1, list, sum);<br>            swap(&amp;list[k], &amp;list[i]);<br>        }<br>    }<br>    return sum;<br>}  </p>
<p>// 功能：矩阵显示<br>// 形参：(输入)矩阵首地址指针Mat，矩阵行数row和列数col。<br>// 返回：无<br>void MatShow(double<em> Mat, int row, int col)<br>{<br>    for (int i = 0; i &lt; row</em>col; i++)<br>    {<br>        printf(“%16lf “, Mat[i]);<br>        if (0 == (i + 1) % col) printf(“\n”);<br>    }<br>}  </p>
<p>// 功能：矩阵相加<br>// 形参：(输入)矩阵A首地址指针A，矩阵B首地址指针B，矩阵A(也是矩阵B)行数row和列数col<br>// 返回：A+B<br>double<em> MatAdd(double</em> A, double<em> B, int row, int col)<br>{<br>    double \</em>Out = (double*)malloc(sizeof(double) <em> row </em> col);<br>    for (int i = 0; i &lt; row; i++)<br>        for (int j = 0; j &lt; col; j++)<br>            Out[col*i + j] = A[col*i + j] + B[col*i + j];<br>    return Out;<br>}  </p>
<p>// 功能：矩阵相减<br>// 形参：(输入)矩阵A，矩阵B，矩阵A(也是矩阵B)行数row和列数col<br>// 返回：A-B<br>double<em> MatSub(double</em> A, double<em> B, int row, int col)<br>{<br>    double \</em>Out = (double*)malloc(sizeof(double) <em> row </em> col);<br>    for (int i = 0; i &lt; row; i++)<br>        for (int j = 0; j &lt; col; j++)<br>            Out[col*i + j] = A[col*i + j] - B[col*i + j];<br>    return Out;<br>}  </p>
<p>// 功能：矩阵相乘<br>// 形参：(输入)矩阵A，矩阵A行数row和列数col，矩阵B，矩阵B行数row和列数col<br>// 返回：A<em>B<br>double</em> MatMul(double<em> A, int Arow, int Acol, double</em> B, int Brow, int Bcol)<br>{<br>    double *Out = (double*)malloc(sizeof(double) <em> Arow </em> Bcol);<br>    if (Acol != Brow)<br>    {<br>        printf(“        Shit!矩阵不可乘!\n”);<br>        return NULL;<br>    }<br>    if (Acol == Brow)<br>    {<br>    int i, j, k;<br>    for (i = 0; i &lt; Arow; i++)<br>        for (j = 0; j &lt; Bcol; j++)<br>        {<br>            Out[Bcol<em>i + j] = 0;<br>            for (k = 0; k &lt; Acol; k++)<br>                Out[Bcol\</em>i + j] = Out[Bcol*i + j] + A[Acol*i + k] * B[Bcol*k + j];<br>        }<br>    return Out;<br>    }<br>}  </p>
<p>// 功能：矩阵数乘(实数k乘以矩阵A)<br>// 形参：(输入)矩阵A首地址指针，矩阵行数row和列数col，实数k<br>// 返回：kA<br>double<em> MatMulk(double </em>A, int row, int col, double k)<br>{<br>    double *Out = (double*)malloc(sizeof(double) <em> row </em> col);<br>    for (int i = 0; i &lt; row <em> col; i++)<br>    {<br>        \</em>Out = *A <em> k;<br>        Out++;<br>        A++;<br>    }<br>    Out = Out - row </em> col;<br>    return Out;<br>}  </p>
<p>// 功能：矩阵转置<br>// 形参：(输入)矩阵A首地址指针A，行数row和列数col<br>// 返回：A的转置<br>double<em> MatT(double</em> A, int row, int col)<br>{<br>    double *Out = (double*)malloc(sizeof(double) <em> row </em> col);<br>    for (int i = 0; i &lt; row; i++)<br>        for (int j = 0; j &lt; col; j++)<br>            Out[row*j + i] = A[col*i + j];<br>    return Out;<br>}  </p>
<p>// 功能：求行列式值<br>// 形参：(输入)矩阵A首地址指针A，行数row<br>// 返回：A的行列式值<br>double MatDet(double <em>A, int row)<br>{<br>    int \</em>list = (int*)malloc(sizeof(int) * row);<br>    for (int i = 0; i &lt; row; i++)<br>        list[i] = i;<br>    double Out = det(A, row, 0, list, 0.0);<br>    free(list);<br>    return Out;<br>}  </p>
<p>// 功能：矩阵的逆<br>// 形参：(输入)矩阵A首地址指针A，行数row和列数col<br>// 返回：A的逆<br>double *MatInv(double *A, int row, int col)<br>{<br>    double *Out = (double*)malloc(sizeof(double) <em> row </em> col);<br>    double det = MatDet(A, row); //求行列式<br>    if (det == 0)<br>    {<br>        printf(“        Fuck!矩阵不可逆!\n”);<br>        return NULL;<br>    }<br>    if (det != 0)<br>    {<br>        Out = MatAdj(A, row, col); //求伴随矩阵<br>        int len = row <em> row;<br>        for (int i = 0; i &lt; len; i++)  
            </em>(Out + i) /= det;<br>        return Out;<br>    }<br>}  </p>
<p>// 功能：求代数余子式<br>// 形参：(输入)矩阵A首地址指针A，矩阵行数row, 元素a的下标m，n(从0开始)，<br>// 返回：NxN 矩阵中元素A(mn)的代数余子式<br>double MatACof(double <em>A, int row, int m, int n)<br>{<br>    int len = (row - 1) </em> (row - 1);<br>    double *cofactor = (double*)malloc(sizeof(double) * len);  </p>
<pre><code>int count = 0;  
int raw_len = row * row;  
for (int i = 0; i &lt; raw_len; i++)  
    if (i / row != m &amp;&amp; i % row != n)  
        *(cofactor + count++) = *(A + i);  
double ret = MatDet(cofactor, row - 1);  
if ((m + n) % 2)  
    ret = -ret;  
free(cofactor);  
return ret;  
</code></pre><p>}  </p>
<p>// 功能：求伴随矩阵<br>// 形参：(输入)矩阵A首地址指针A，行数row和列数col<br>// 返回：A的伴随矩阵<br>double *MatAdj(double *A, int row, int col)<br>{<br>    double *Out = (double*)malloc(sizeof(double) <em> row </em> col);<br>    int len = row <em> row;<br>    int count = 0;<br>    for (int i = 0; i &lt; len; i++)<br>    {  
        </em>(Out + count++) = MatACof(A, row, i % row, i / row);<br>    }<br>    return Out;<br>}  </p>
<p>// 读取文件行数<br>int FileReadRow(const char <em>filename)<br>{<br>    FILE </em>f = fopen(filename, “r”);<br>    int i = 0;<br>    char str[4096];<br>    while (NULL != fgets(str, 4096, f))<br>        ++i;<br>    printf(“数组行数：%d\n”, i);<br>    return i;<br>}  </p>
<p>// 读取文件每行数据数(逗号数+1)<br>int FileReadCol(const char <em>filename)<br>{<br>    FILE </em>f = fopen(filename, “r”);<br>    int i = 0;<br>    char str[4096];<br>    fgets(str, 4096, f);<br>    for (int j = 0; j &lt; strlen(str); j++)<br>    {<br>        if (‘,’ == str[j]) i++;<br>    }<br>    i++;// 数据数=逗号数+1<br>    printf(“数组列数：%d\n”, i);<br>    return i;<br>}  </p>
<p>// 逗号间隔数据提取<br>void GetCommaData(char str_In[4096], double double_Out[1024])<br>{<br>    int str_In_len = strlen(str_In);<br>    //printf(“str_In_len:%d\n”, str_In_len);<br>    char str_Data_temp[128];<br>    int j = 0;<br>    int double_Out_num = 0;<br>    for (int i = 0; i &lt; str_In_len; i++)<br>    {<br>        //不是逗号，则是数据，存入临时数组中<br>        if (‘,’ != str_In[i]) str_Data_temp[j++] = str_In[i];<br>        //是逗号或\n(最后一个数据)，则数据转换为double，保存到输出数组<br>        if (‘,’ == str_In[i] || ‘\n’ == str_In[i]) { str_Data_temp[j] = ‘\0’; j = 0; /*printf(“str_Data_temp:%s\n”, str_Data_temp); */double_Out[double_Out_num++] = atof(str_Data_temp); memset(str_Data_temp, 0, sizeof(str_Data_temp)); }<br>    }<br>}  </p>
<p>// 功能：从csv文件读矩阵，保存到指针中<br>// 形参：(输入)csv文件名，预计行数row和列数col<br>// 返回：矩阵指针A<br>double *MatRead(char *csvFileName)<br>{<br>    int row = FileReadRow(csvFileName);<br>    int col = FileReadCol(csvFileName);<br>    double *Out = (double*)malloc(sizeof(double) <em> row </em> col);<br>    FILE <em>f = fopen(csvFileName, “r”);<br>    char buffer[4096];<br>    while (fgets(buffer, sizeof(buffer), f))<br>    {<br>        //printf(“buffer[%s]\n”,buffer);<br>        double double_Out[128] = { 0 };<br>        GetCommaData(buffer, double_Out);<br>        for (int i = 0; i &lt; col; i++)<br>        {<br>            //printf(“double_Out:%lf\n”, double_Out[i]);  
            </em>Out = double_Out[i];<br>            Out++;<br>        }  </p>
<pre><code>}  
Out = Out - row * col;//指针移回数据开头  
fclose(f);  
return Out;  
</code></pre><p>}  </p>
<p>// 功能：将矩阵A存入csv文件中<br>// 形参：(输入)保存的csv文件名，矩阵A首地址指针A，行数row和列数col<br>// 返回：无<br>void MatWrite(const char *csvFileName, double *A, int row, int col)<br>{<br>    FILE <em>DateFile;<br>    double </em>Ap = A;<br>    DateFile = fopen(csvFileName, “w”);//追加的方式保存生成的时间戳<br>    for (int i = 0; i &lt; row<em>col; i++)<br>    {<br>        if ((i+1) % col == 0) fprintf(DateFile, “%lf\n”, </em>Ap);//保存到文件，到列数换行<br>        else fprintf(DateFile, “%lf,”, *Ap);//加逗号<br>        Ap++;<br>    }<br>    fclose(DateFile);<br>}</p>
<p>运行结果如图：</p>

      
    </div>

    <div>
      
        

      
    </div>
  


    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>🐶 您的支持将鼓励我继续创作 🐶</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>赞赏</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="/images/wechat-reward-img.jpg" alt="Sandeepin WeChat Pay"/>
          <p>微信打赏</p>
        </div>
      
      
        <div id="alipay" style="display: inline-block">
          <img id="alipay_qr" src="/images/alipay-reward-img.jpg" alt="Sandeepin Alipay"/>
          <p>支付宝打赏</p>
        </div>
      
    </div>
  </div>


      
    </div>


    <footer class="post-footer">
        
     <div>    
      
      <ul class="post-copyright">
         <li class="post-copyright-link">
          <strong>本文作者：</strong>
          <a href="/" title="欢迎访问 Sandeepin 的个人博客">Sandeepin</a>
        </li>

        <li class="post-copyright-link">
          <strong>本文标题：</strong>
          <a href="http://blog.jfz.me/2016/jfz-cmatlib.html" title="异想家纯C语言矩阵运算库">异想家纯C语言矩阵运算库</a>
        </li>

        <li class="post-copyright-link">
          <strong>本文链接：</strong>
          <a href="http://blog.jfz.me/2016/jfz-cmatlib.html" title="异想家纯C语言矩阵运算库">http://blog.jfz.me/2016/jfz-cmatlib.html</a>
        </li>

        <li class="post-copyright-date">
            <strong>发布时间：</strong>2016年11月30日 - 19时11分
        </li>  

        <li class="post-copyright-license">
          <strong>版权声明： </strong>
          本文由 Sandeepin 原创，采用 <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh" rel="license" target="_blank">保留署名-非商业性使用-禁止演绎 4.0-国际许可协议</a> </br>转载请保留以上声明信息！
        </li>
      </ul>
    
  </div>  
      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/macmini-win7-install.html" rel="next" title="2014年末Mac mini装Win7的方法">
                <i class="fa fa-chevron-left"></i> 2014年末Mac mini装Win7的方法
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/c-string-code.html" rel="prev" title="C语言字符串处理">
                C语言字符串处理 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="lv-container" data-id="city" data-uid="MTAyMC8zMjI4My84ODQ3"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Sandeepin" />
          <p class="site-author-name" itemprop="name">Sandeepin</p>
          <p class="site-description motion-element" itemprop="description">异想博客</p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">79</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">17</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/EZLippi" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/ouyanglip" target="_blank" title="weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.zhihu.com/people/lippi-ouyang" target="_blank" title="zhihu">
                  
                    <i class="fa fa-fw fa-battery-3"></i>
                  
                  zhihu
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友情链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.woaitqs.cc/" title="Qisen Tang" target="_blank">Qisen Tang</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://szhshp.org" title="szhshp的博客" target="_blank">szhshp的博客</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://python.zhangwei.website" title="JuniorCoder" target="_blank">JuniorCoder</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://hippo-jessy.com" title="Hippo" target="_blank">Hippo</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.zhihu.com/people/lippi-ouyang" title="友链出租" target="_blank">友链出租</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2008 - 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Sandeepin</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io" rel="external nofollow">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next" rel="external nofollow">
    NexT.Mist
  </a>| Hosted by <a href="https://pages.coding.me" style="font-weight: bold">Coding Pages</a>
</div>





        

<div class="busuanzi-count">

  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span>
  

  
    <span class="site-pv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span>
  
  
</div>



        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="//cdn.jsdelivr.net/jquery/2.1.3/jquery.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/fastclick/1.0.6/fastclick.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/jquery.lazyload/1.9.3/jquery.lazyload.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/velocity/1.2.3/velocity.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/velocity/1.2.3/velocity.ui.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/fancybox/2.1.5/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  

  
      <!-- UY BEGIN -->
      <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid="></script>
      <!-- UY END -->
  



  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  


  
  

  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("kJ2sJuSJeByLioULSXrJ5CSq-9Nh9j0Va", "uBWeNxCbFEWsOVDTmAInrDq3");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

	<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>

</body>
</html>
